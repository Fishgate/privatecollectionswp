function updateViewportDimensions(){var e=window,i=document,t=i.documentElement,a=i.getElementsByTagName("body")[0],n=e.innerWidth||t.clientWidth||a.clientWidth,r=e.innerHeight||t.clientHeight||a.clientHeight;return{width:n,height:r}}function loadGravatars(){viewport=updateViewportDimensions(),viewport.width>=768&&jQuery(".comment img[data-gravatar]").each(function(){jQuery(this).attr("src",jQuery(this).attr("data-gravatar"))})}var viewport=updateViewportDimensions(),waitForFinalEvent=function(){var e={};return function(i,t,a){a||(a="Don't call this twice without a uniqueId"),e[a]&&clearTimeout(e[a]),e[a]=setTimeout(i,t)}}(),timeToWaitForLast=100;jQuery(document).ready(function(e){function i(){viewport=updateViewportDimensions(),gallery_width=e("#gallery-images").width(),gallery_height=viewport.height-(e("#inner-header").height()+80),viewport.width>=1030?e("#gallery-images .img-overlay-panel .gallery-image").css({"max-width":gallery_width,"max-height":gallery_height}):e("#gallery-images .img-overlay-panel .gallery-image").removeAttr("style"),image_width=e("#gallery-images .img-overlay-panel .gallery-image").width(),image_height=e("#gallery-images .img-overlay-panel .gallery-image").height(),e("#gallery-images .img-overlay-panel .overlay").css({width:image_width}),e("#gallery-images .img-overlay-panel .overlay p").css({"margin-top":image_height/2})}function t(){return total_list_items=e("#gallery-nav .list-holder ul").children().length-3,spacing_per_item=123,scroll_position_limit=-1*total_list_items*spacing_per_item}function a(){currentpos=e("#gallery-nav .list-holder ul").position(),currentpos_top=Math.round(currentpos.top),currentpos_top!==t()&&(e(this).unbind("click"),e("#gallery-nav .list-holder ul").finish().animate({top:"-=123"},300,"swing",function(){e("#gallery-nav .scroll-down").click(a)}))}function n(){currentpos=e("#gallery-nav .list-holder ul").position(),currentpos_top=Math.round(currentpos.top),0!==currentpos_top&&(e(this).unbind("click"),e("#gallery-nav .list-holder ul").finish().animate({top:"+=123"},300,"swing",function(){e("#gallery-nav .scroll-up").click(n)}))}loadGravatars(),e(".album-feature .img-overlay-panel .overlay p").flowtype({minimum:74,maximum:95,fontRatio:9}),viewport=updateViewportDimensions();var r=e.parseJSON(site_data.bg_slideshow);viewport.width>=768&&e.supersized({slide_interval:1e4,transition:1,transition_speed:1e3,slides:r}),e("#gallery-images").bind({mouseenter:function(){e(this).find(".overlay").stop().fadeIn()},mouseleave:function(){e(this).find(".overlay").stop().fadeOut()}}),e("#gallery-images").length>0&&i(),e(".gallery-thumb").each(function(){e(this).click(function(){this_btn=e(this),this_btn.hasClass("current-img")||(this_btn.find(".overlay").removeClass("hidden"),image_name=e(this).data("img-id"),image_path=site_data.template_dir+"/library/images/temp/"+image_name.toString(),e("img.gallery-image").attr("src",image_path).load(function(){i(),this_btn.find(".overlay").addClass("hidden"),e(".gallery-thumb").removeClass("current-img"),this_btn.addClass("current-img")}))})}),e("#gallery-nav .scroll-down").click(a),e("#gallery-nav .scroll-up").click(n),e(window).resize(function(){e("#gallery-images").length>0&&i()})});